</div>
<h3 class="font-bold text-lg mb-2">Deep Classification</h3>
<p class="text-slate-500 text-sm">Go beyond the basics. Master abstract, collective, and compound nuances.</p>
</div>
<div class="bg-white p-6 rounded-xl shadow-sm border border-slate-100 hover:shadow-md transition">
<div class="bg-purple-100 w-12 h-12 rounded-full flex items-center justify-center text-purple-600 mb-4">
<span class="material-symbols-outlined">psychology</span>
</div>
<h3 class="font-bold text-lg mb-2">Critical Thinking</h3>
<p class="text-slate-500 text-sm">Solve puzzles involving material nouns and complex countability rules.</p>
</div>
<div class="bg-white p-6 rounded-xl shadow-sm border border-slate-100 hover:shadow-md transition">
<div class="bg-yellow-100 w-12 h-12 rounded-full flex items-center justify-center text-yellow-600 mb-4">
<span class="material-symbols-outlined">workspace_premium</span>
</div>
<h3 class="font-bold text-lg mb-2">Certification</h3>
<p class="text-slate-500 text-sm">Pass the Final Exam to earn your personalized, shareable certificate.</p>
</div>
</div>
<button class="group relative inline-flex items-center justify-center px-8 py-4 text-lg font-bold text-white transition-all duration-200 bg-indigo-600 font-lg rounded-full hover:bg-indigo-700 hover:shadow-xl focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-600" onclick="nextStep()">
            Enter the Academy
            <span class="material-symbols-outlined ml-2 group-hover:translate-x-1 transition">arrow_forward</span>
</button>
</div>
</template>

<!-- 1. ADVANCED TYPES -->
<template id="view-types">
<div class="space-y-8 fade-in">
<div class="text-center max-w-3xl mx-auto">
<span class="text-indigo-500 font-bold tracking-wider text-sm uppercase">Lesson 1</span>
<h2 class="text-4xl font-bold text-slate-800 fun-font mb-4">The Noun Spectrum</h2>
<p class="text-slate-600 text-lg">Nouns aren't just names. They are concepts, groups, and specific entities. Let's analyze the four core pillars.</p>
</div>
<!-- Theory Cards -->
<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
<!-- Proper -->
<div class="bg-white p-6 rounded-xl shadow-sm border-t-4 border-blue-500 hover:-translate-y-1 transition duration-300">
<h3 class="font-bold text-xl text-slate-700 mb-2">Proper Nouns</h3>
<p class="text-sm text-slate-500 mb-4">Specific names of unique entities. Always capitalized.</p>
<ul class="text-sm space-y-1 bg-blue-50 p-3 rounded text-blue-800">
<li>‚Ä¢ <b>E</b>iffel <b>T</b>ower</li>
<li>‚Ä¢ <b>J</b>upiter</li>
<li>‚Ä¢ <b>S</b>aturday</li>
</ul>
</div>
<!-- Common -->
<div class="bg-white p-6 rounded-xl shadow-sm border-t-4 border-emerald-500 hover:-translate-y-1 transition duration-300">
<h3 class="font-bold text-xl text-slate-700 mb-2">Common Nouns</h3>
<p class="text-sm text-slate-500 mb-4">General names for a class of things.</p>
<ul class="text-sm space-y-1 bg-emerald-50 p-3 rounded text-emerald-800">
<li>‚Ä¢ city (vs London)</li>
<li>‚Ä¢ planet (vs Mars)</li>
<li>‚Ä¢ teacher (vs Mr. Smith)</li>
</ul>
</div>
<!-- Abstract -->
<div class="bg-white p-6 rounded-xl shadow-sm border-t-4 border-purple-500 hover:-translate-y-1 transition duration-300">
<h3 class="font-bold text-xl text-slate-700 mb-2">Abstract Nouns</h3>
<p class="text-sm text-slate-500 mb-4">Ideas, qualities, or states. Invisible to the eye.</p>
<ul class="text-sm space-y-1 bg-purple-50 p-3 rounded text-purple-800">
<li>‚Ä¢ Bravery</li>
<li>‚Ä¢ Childhood</li>
<li>‚Ä¢ Wisdom</li>
</ul>
</div>
<!-- Collective -->
<div class="bg-white p-6 rounded-xl shadow-sm border-t-4 border-orange-500 hover:-translate-y-1 transition duration-300">
<h3 class="font-bold text-xl text-slate-700 mb-2">Collective Nouns</h3>
<p class="text-sm text-slate-500 mb-4">A single word representing a group.</p>
<ul class="text-sm space-y-1 bg-orange-50 p-3 rounded text-orange-800">
<li>‚Ä¢ A <b>pride</b> of lions</li>
<li>‚Ä¢ A <b>choir</b> of singers</li>
<li>‚Ä¢ A <b>fleet</b> of ships</li>
</ul>
</div>
</div>
<!-- Mini Game: The Sort -->
<div class="bg-slate-900 rounded-2xl p-6 md:p-8 text-white mt-8 shadow-2xl">
<div class="flex flex-col md:flex-row justify-between items-start md:items-center mb-6">
<div>
<h3 class="text-2xl font-bold text-yellow-400 fun-font flex items-center gap-2">
<span class="material-symbols-outlined">sports_esports</span> Challenge: The Sorting Hat
                    </h3>
<p class="text-slate-400 text-sm">Click the correct category for the word displayed below.</p>
</div>
<div class="mt-4 md:mt-0 bg-slate-800 px-4 py-2 rounded-lg border border-slate-700">
                    Score: <span class="text-yellow-400 font-bold" id="sort-score">0</span>/5
                </div>
</div>
<div class="text-center py-8">
<div class="text-4xl md:text-6xl font-black text-white mb-8 animate-bounce" id="sort-word-display">Loading...</div>
<div class="grid grid-cols-2 md:grid-cols-4 gap-4 max-w-3xl mx-auto">
<button class="bg-blue-600 hover:bg-blue-500 border-b-4 border-blue-800 py-4 rounded-xl font-bold transition active:scale-95" onclick="checkSort('Proper')">Proper</button>
<button class="bg-emerald-600 hover:bg-emerald-500 border-b-4 border-emerald-800 py-4 rounded-xl font-bold transition active:scale-95" onclick="checkSort('Common')">Common</button>
<button class="bg-purple-600 hover:bg-purple-500 border-b-4 border-purple-800 py-4 rounded-xl font-bold transition active:scale-95" onclick="checkSort('Abstract')">Abstract</button>
<button class="bg-orange-600 hover:bg-orange-500 border-b-4 border-orange-800 py-4 rounded-xl font-bold transition active:scale-95" onclick="checkSort('Collective')">Collective</button>
</div>
<div class="h-8 mt-4 font-bold text-lg" id="sort-feedback"></div>
</div>
</div>
<div class="flex justify-between pt-8">
<button class="text-slate-500 hover:text-slate-800 font-bold flex items-center gap-2" onclick="prevStep()">
<span class="material-symbols-outlined">arrow_back</span> Back
            </button>
<button class="bg-slate-300 text-white font-bold py-3 px-8 rounded-full cursor-not-allowed flex items-center gap-2" disabled="" id="btn-next-1">
                Complete Challenge to Continue <span class="material-symbols-outlined">lock</span>
</button>
</div>
</div>
</template>

<!-- 2. CONCRETE VS MATERIAL -->
<template id="view-material">
<div class="space-y-8 fade-in">
<div class="text-center max-w-3xl mx-auto">
<span class="text-indigo-500 font-bold tracking-wider text-sm uppercase">Lesson 2</span>
<h2 class="text-4xl font-bold text-slate-800 fun-font mb-4">Substance vs. Object</h2>
</div>
<!-- Deep Dive Explanation -->
<div class="grid grid-cols-1 md:grid-cols-2 gap-8 items-stretch">
<!-- Concrete -->
<div class="bg-white rounded-2xl shadow-lg overflow-hidden flex flex-col">
<img alt="Gold Ring" class="w-full h-48 object-cover" src="https://images.unsplash.com/photo-1605100804763-247f67b3557e?q=80&amp;w=2070&amp;auto=format&amp;fit=crop">
<div class="p-6 flex-grow">
<h3 class="text-2xl font-bold text-slate-800 mb-2">Concrete Noun</h3>
<p class="text-slate-600 mb-4">Objects with a definite shape that you can perceive with your 5 senses. You can typically count them.</p>
<div class="bg-slate-50 p-4 rounded-lg">
<p class="font-bold text-slate-700">"The Ring"</p>
<p class="text-sm text-slate-500">I can touch it, see it, and count it (one ring, two rings).</p>
</div>
</div>
</div>
<!-- Material -->
<div class="bg-white rounded-2xl shadow-lg overflow-hidden flex flex-col">
<img alt="Molten Gold" class="w-full h-48 object-cover" src="https://images.unsplash.com/photo-1610375461246-83df859d849d?q=80&amp;w=2070&amp;auto=format&amp;fit=crop">
<div class="p-6 flex-grow">
<h3 class="text-2xl font-bold text-slate-800 mb-2">Material Noun</h3>
<p class="text-slate-600 mb-4">The substance, matter, or ingredient used to make things. Usually uncountable in its raw form.</p>
<div class="bg-slate-50 p-4 rounded-lg">
<p class="font-bold text-slate-700">"The Gold"</p>
<p class="text-sm text-slate-500">I can't count "one gold". It is the material the ring is made of.</p>
</div>
</div>
</div>
</div>
<!-- Exercise: The Lab -->
<div class="bg-indigo-50 border border-indigo-100 rounded-2xl p-6 md:p-8 mt-8">
<h3 class="text-2xl font-bold text-indigo-900 fun-font mb-6 text-center">üß™ The Material Lab</h3>
<p class="text-center text-indigo-700 mb-6">Identify the <b>Material Noun</b> hidden in the sentences below.</p>
<div class="space-y-4 max-w-2xl mx-auto" id="material-quiz-container">
<!-- Questions injected -->
</div>
</div>
<div class="flex justify-between pt-8">
<button class="text-slate-500 hover:text-slate-800 font-bold flex items-center gap-2" onclick="prevStep()">
<span class="material-symbols-outlined">arrow_back</span> Back
            </button>
<button class="bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-3 px-8 rounded-full shadow-lg flex items-center gap-2 transition" id="btn-next-2" onclick="nextStep()">
                Next Lesson <span class="material-symbols-outlined">arrow_forward</span>
</button>
</div>
</div>
</template>

<!-- 3. COMPOUND NOUNS -->
<template id="view-compound">
<div class="space-y-8 fade-in">
<div class="text-center max-w-3xl mx-auto">
<span class="text-indigo-500 font-bold tracking-wider text-sm uppercase">Lesson 3</span>
<h2 class="text-4xl font-bold text-slate-800 fun-font mb-4">Compound Constructors</h2>
<p class="text-slate-600">Sometimes one word isn't enough. We weld words together to create new meanings.</p>
</div>
<div class="bg-white rounded-2xl shadow-sm border border-slate-200 p-6 md:p-8">
<h3 class="font-bold text-lg text-slate-700 mb-4">The 3 Forms of Compounds</h3>
<div class="grid grid-cols-1 md:grid-cols-3 gap-6">
<div class="bg-blue-50 p-4 rounded-xl text-center">
<div class="font-bold text-blue-800 text-xl mb-1">Closed</div>
<p class="text-sm text-blue-600 mb-2">No spaces</p>
<div class="bg-white py-2 px-4 rounded shadow-sm inline-block font-mono text-slate-700">toothpaste</div>
</div>
<div class="bg-orange-50 p-4 rounded-xl text-center">
<div class="font-bold text-orange-800 text-xl mb-1">Hyphenated</div>
<p class="text-sm text-orange-600 mb-2">Connected by -</p>
<div class="bg-white py-2 px-4 rounded shadow-sm inline-block font-mono text-slate-700">six-pack</div>
</div>
<div class="bg-purple-50 p-4 rounded-xl text-center">
<div class="font-bold text-purple-800 text-xl mb-1">Open</div>
<p class="text-sm text-purple-600 mb-2">Separate words</p>
<div class="bg-white py-2 px-4 rounded shadow-sm inline-block font-mono text-slate-700">ice cream</div>
</div>
</div>
</div>
<!-- Builder Game -->
<div class="bg-slate-800 rounded-2xl p-8 text-white shadow-xl relative overflow-hidden">
<div class="relative z-10">
<h3 class="text-2xl font-bold text-yellow-400 fun-font mb-2">üè≠ The Word Factory</h3>
<p class="text-slate-300 mb-8">Combine the correct base words to form the target Compound Noun.</p>
<div class="bg-white/10 rounded-xl p-6 text-center mb-8">
<p class="text-sm text-slate-400 uppercase tracking-widest mb-2">Target Word Definition</p>
<p class="text-2xl md:text-3xl font-bold text-white" id="compound-def">"A light that guides ships at sea"</p>
</div>
<div class="grid grid-cols-2 gap-4 max-w-2xl mx-auto" id="compound-options">
<!-- Options injected -->
</div>
<p class="text-center mt-4 h-6 font-bold text-green-400" id="compound-feedback"></p>
</div>
</div>
<div class="flex justify-between pt-8">
<button class="text-slate-500 hover:text-slate-800 font-bold flex items-center gap-2" onclick="prevStep()">
<span class="material-symbols-outlined">arrow_back</span> Back
            </button>
<button class="bg-slate-300 text-white font-bold py-3 px-8 rounded-full cursor-not-allowed flex items-center gap-2" disabled="" id="btn-next-3">
                Complete Factory to Continue <span class="material-symbols-outlined">lock</span>
</button>
</div>
</div>
</template>

<!-- 4. COUNTABLE VS UNCOUNTABLE -->
<template id="view-countable">
<div class="space-y-8 fade-in">
<div class="text-center max-w-3xl mx-auto">
<span class="text-indigo-500 font-bold tracking-wider text-sm uppercase">Lesson 4</span>
<h2 class="text-4xl font-bold text-slate-800 fun-font mb-4">The Quantifier Kitchen</h2>
</div>
<!-- Advanced Rule Cards -->
<div class="grid grid-cols-1 md:grid-cols-2 gap-6">
<div class="bg-white p-6 rounded-xl border-l-4 border-rose-500 shadow-sm">
<h3 class="font-bold text-xl text-rose-600 mb-2">Advanced Uncountable Rules</h3>
<ul class="space-y-2 text-sm text-slate-600">
<li class="flex items-start gap-2"><span class="material-symbols-outlined text-rose-500 text-sm mt-0.5">block</span> <b>Liquids &amp; Powders:</b> Milk, water, rice, sugar.</li>
<li class="flex items-start gap-2"><span class="material-symbols-outlined text-rose-500 text-sm mt-0.5">block</span> <b>Abstract Ideas:</b> Information, advice, news.</li>
<li class="flex items-start gap-2"><span class="material-symbols-outlined text-rose-500 text-sm mt-0.5">block</span> <b>Materials:</b> Wood, glass, gold.</li>
</ul>
</div>
<div class="bg-white p-6 rounded-xl border-l-4 border-teal-500 shadow-sm">
<h3 class="font-bold text-xl text-teal-600 mb-2">Measuring the Unmeasurable</h3>
<p class="text-sm text-slate-600 mb-3">To count them, we use <b>Partitives</b> (containers or units):</p>
<div class="grid grid-cols-2 gap-2 text-sm font-bold text-slate-700">
<div class="bg-teal-50 p-2 rounded">A <u>loaf</u> of bread</div>
<div class="bg-teal-50 p-2 rounded">A <u>bar</u> of chocolate</div>
<div class="bg-teal-50 p-2 rounded">A <u>grain</u> of rice</div>
<div class="bg-teal-50 p-2 rounded">A <u>piece</u> of advice</div>
</div>
</div>
</div>
<!-- Interactive Fridge -->
<div class="bg-blue-50 rounded-3xl p-6 md:p-8 border-4 border-white shadow-xl relative">
<h3 class="text-center text-2xl font-bold text-blue-900 fun-font mb-6">ü•ë Fridge Sorter</h3>
<p class="text-center text-blue-700 mb-6">Click the item to place it in the correct container.</p>
<div class="flex justify-center mb-8">
<div class="bg-white w-40 h-40 rounded-full flex flex-col items-center justify-center shadow-lg border-4 border-yellow-300 transform transition-all duration-300 cursor-pointer" id="fridge-item">
<!-- Item Image & Name Injected -->
</div>
</div>
<div class="grid grid-cols-2 gap-8 max-w-2xl mx-auto">
<button class="bg-white hover:bg-green-50 border-2 border-dashed border-green-400 rounded-2xl p-6 flex flex-col items-center transition group" onclick="sortFridge('Countable')">
<span class="material-symbols-outlined text-4xl text-green-500 mb-2 group-hover:scale-110 transition">looks_one</span>
<span class="font-bold text-green-700">Countable Basket</span>
<span class="text-xs text-green-500">(1, 2, 3...)</span>
</button>
<button class="bg-white hover:bg-rose-50 border-2 border-dashed border-rose-400 rounded-2xl p-6 flex flex-col items-center transition group" onclick="sortFridge('Uncountable')">
<span class="material-symbols-outlined text-4xl text-rose-500 mb-2 group-hover:scale-110 transition">water_drop</span>
<span class="font-bold text-rose-700">Uncountable Jar</span>
<span class="text-xs text-rose-500">(Some, A little...)</span>
</button>
</div>
<p class="text-center mt-6 font-bold text-blue-800" id="fridge-status">Items sorted: 0/6</p>
</div>
<div class="flex justify-between pt-8">
<button class="text-slate-500 hover:text-slate-800 font-bold flex items-center gap-2" onclick="prevStep()">
<span class="material-symbols-outlined">arrow_back</span> Back
            </button>
<button class="bg-slate-300 text-white font-bold py-3 px-8 rounded-full cursor-not-allowed flex items-center gap-2" disabled="" id="btn-next-4">
                Finish Sorting to Continue <span class="material-symbols-outlined">lock</span>
</button>
</div>
</div>
</template>

<!-- 5. FINAL EXAM -->
<template id="view-exam">
<div class="max-w-2xl mx-auto space-y-8 fade-in">
<div class="text-center">
<div class="inline-block bg-indigo-100 text-indigo-700 p-3 rounded-full mb-4">
<span class="material-symbols-outlined text-3xl">edit_document</span>
</div>
<h2 class="text-3xl font-bold text-slate-800 fun-font">Final Certification Exam</h2>
<p class="text-slate-600 mt-2">10 Questions. Prove your mastery.</p>
<div class="w-full bg-slate-200 rounded-full h-3 mt-6">
<div class="bg-indigo-600 h-3 rounded-full transition-all duration-500" id="exam-progress" style="width: 0%"></div>
</div>
<div class="flex justify-between text-xs text-slate-500 mt-1 font-bold">
<span>Start</span>
<span id="exam-counter">1/10</span>
</div>
</div>
<div class="bg-white p-8 rounded-2xl shadow-xl border-t-4 border-indigo-600 min-h-[300px] flex flex-col justify-center" id="exam-card">
<!-- Question Injected -->
</div>
</div>
</template>

<!-- 6. CERTIFICATE VIEW -->
<template id="view-certificate">
<div class="flex flex-col items-center justify-center min-h-[60vh] fade-in space-y-8">
<h2 class="text-3xl font-bold text-slate-800 fun-font text-center">Congratulations, Graduate!</h2>
<!-- Certificate Input -->
<div class="bg-white p-6 rounded-xl shadow-lg border border-slate-200 w-full max-w-md text-center space-y-4" id="cert-input-area">
<p class="text-slate-600">Enter your name to generate your official certificate.</p>
<input class="w-full p-3 border-2 border-slate-300 rounded-lg font-bold text-center text-lg focus:border-indigo-500 focus:outline-none" id="student-name" placeholder="Your Name Here" type="text">
<button class="w-full bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-3 rounded-lg shadow-md transition" onclick="generateCertificate()">Generate Certificate</button>
</div>
<!-- The Certificate (Hidden initially) -->
<div class="hidden w-full max-w-4xl" id="certificate-display">
<!-- Print/Share Actions -->
<div class="flex flex-wrap justify-center gap-4 mb-8 no-print">
<button class="bg-slate-800 hover:bg-slate-900 text-white font-bold py-2 px-6 rounded-full flex items-center gap-2 shadow-lg" onclick="window.print()">
<span class="material-symbols-outlined">print</span> Print / Save PDF
                </button>
<button class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-6 rounded-full flex items-center gap-2 shadow-lg" onclick="shareResult()">
<span class="material-symbols-outlined">share</span> Share Score
                </button>
<button class="bg-white border-2 border-slate-200 text-slate-600 hover:bg-slate-50 font-bold py-2 px-6 rounded-full flex items-center gap-2 shadow-lg" onclick="resetApp()">
<span class="material-symbols-outlined">refresh</span> New Student
                </button>
</div>
<!-- Actual Certificate DOM -->
<div class="bg-white p-10 border-8 border-double border-slate-800 relative text-center certificate-bg shadow-2xl mx-auto aspect-[1.414/1] flex flex-col justify-between max-w-[800px]" id="certificate-area">
<!-- Decorative Corners -->
<div class="absolute top-4 left-4 border-t-4 border-l-4 border-yellow-500 w-16 h-16"></div>
<div class="absolute top-4 right-4 border-t-4 border-r-4 border-yellow-500 w-16 h-16"></div>
<div class="absolute bottom-4 left-4 border-b-4 border-l-4 border-yellow-500 w-16 h-16"></div>
<div class="absolute bottom-4 right-4 border-b-4 border-r-4 border-yellow-500 w-16 h-16"></div>
<!-- Header -->
<div class="mt-8">
<div class="inline-block bg-slate-800 text-white px-4 py-1 rounded mb-4 text-sm font-bold tracking-[0.2em] uppercase">Certificate of Excellence</div>
<h1 class="text-5xl md:text-6xl font-serif text-slate-800 mb-2">Noun Master Academy</h1>
<div class="w-32 h-1 bg-yellow-500 mx-auto"></div>
</div>
<!-- Body -->
<div class="flex-grow flex flex-col justify-center space-y-2">
<p class="text-slate-500 text-lg italic">This certifies that</p>
<h2 class="text-4xl md:text-5xl font-bold text-indigo-700 fun-font py-4 border-b border-slate-200 mx-12" id="cert-name">Student Name</h2>
<p class="text-slate-600 text-lg mt-4">Has successfully completed the <b>Grade 6 Advanced Noun Module</b><br>demonstrating superior knowledge in Noun Classification and Usage.</p>
<p class="text-xl font-bold text-slate-800 mt-4">Final Score: <span class="text-indigo-600" id="cert-score">100%</span></p>
</div>
<!-- Footer -->
<div class="flex justify-between items-end px-12 pb-8 mt-8">
<div class="text-center">
<div class="w-40 border-b-2 border-slate-400 mb-2"></div>
<p class="text-xs font-bold text-slate-400 uppercase tracking-wider">Date</p>
<p class="font-serif text-slate-600" id="cert-date"></p>
</div>
<div class="w-24 h-24 bg-yellow-400 rounded-full flex items-center justify-center text-yellow-800 border-4 border-yellow-200 shadow-inner">
<span class="material-symbols-outlined text-5xl">verified</span>
</div>
<div class="text-center">
<div class="w-40 border-b-2 border-slate-400 mb-2 font-dancing text-2xl text-indigo-800" style="font-family: cursive;">Prof. Grammar</div>
<p class="text-xs font-bold text-slate-400 uppercase tracking-wider">Head of Department</p>
</div>
</div>
</div>
</div>
</div>
</template>

<script>
        // === DATASETS ===

        // 1. Sorting Game Data
        const sortingWords = [
            { word: "Happiness", type: "Abstract" },
            { word: "New York", type: "Proper" },
            { word: "Team", type: "Collective" },
            { word: "Computer", type: "Common" },
            { word: "Flock", type: "Collective" }
        ];

        // 2. Material Quiz Data
        const materialQuestions = [
            { sentence: "The sturdy table was made of <span class='text-indigo-600 font-bold'>Oak</span>.", answer: "Oak", options: ["Table", "Oak", "Sturdy"] },
            { sentence: "She wore a scarf made of <span class='text-indigo-600 font-bold'>Silk</span>.", answer: "Silk", options: ["Scarf", "She", "Silk"] },
            { sentence: "The wall is built from <span class='text-indigo-600 font-bold'>Brick</span>.", answer: "Brick", options: ["Wall", "Brick", "Built"] }
        ];

        // 3. Compound Builder Data
        const compoundLevels = [
            { def: "A structured guiding light for ships", part1: ["Light", "Sea", "Ship"], part2: ["House", "Home", "Beam"], answer: "Lighthouse" },
            { def: "A brush used for cleaning teeth", part1: ["Mouth", "Tooth", "Gum"], part2: ["Paste", "Stick", "Brush"], answer: "Toothbrush" },
            { def: "Frozen precipitation that falls gently", part1: ["Ice", "Cold", "Snow"], part2: ["Drop", "Fall", "Flake"], answer: "Snowflake" }
        ];

        // 4. Fridge Items
        const fridgeItems = [
            { name: "Apples", type: "Countable", icon: "nutrition" },
            { name: "Milk", type: "Uncountable", icon: "water_drop" },
            { name: "Eggs", type: "Countable", icon: "egg" },
            { name: "Rice", type: "Uncountable", icon: "grain" },
            { name: "Information", type: "Uncountable", icon: "info" }, // tricky abstract!
            { name: "Burgers", type: "Countable", icon: "lunch_dining" }
        ];

        // 5. Final Exam
        const examQuestions = [
            { q: "Which word is a Proper Noun?", options: ["city", "Paris", "country", "village"], a: 1 },
            { q: "Identify the Abstract Noun.", options: ["Book", "Smart", "Intelligence", "Brain"], a: 2 },
            { q: "Which is a Collective Noun?", options: ["Swarm", "Bee", "Hive", "Honey"], a: 0 },
            { q: "Is 'Butter' Countable or Uncountable?", options: ["Countable", "Uncountable"], a: 1 },
            { q: "Select the Compound Noun.", options: ["Running", "Fastest", "Bedroom", "Silly"], a: 2 },
            { q: "'A fleet of ships'. 'Fleet' is:", options: ["Common", "Proper", "Collective", "Abstract"], a: 2 },
            { q: "Which is a Material Noun?", options: ["Chair", "Wood", "Table", "Tree"], a: 1 },
            { q: "How do we count 'Water'?", options: ["One water", "A glass of water", "Many waters", "A water"], a: 1 },
            { q: "Find the Concrete Noun.", options: ["Freedom", "Idea", "Pizza", "Dream"], a: 2 },
            { q: "Plural of 'Child'?", options: ["Childs", "Children", "Childrens", "Childes"], a: 1 }
        ];

        // === STATE ===
        let currentState = {
            step: 0,
            score: 0,
            sortIndex: 0,
            sortScore: 0,
            compoundIndex: 0,
            fridgeIndex: 0,
            fridgeScore: 0,
            examIndex: 0,
            examScore: 0
        };

        const steps = ['view-welcome', 'view-types', 'view-material', 'view-compound', 'view-countable', 'view-exam', 'view-certificate'];

        // === CORE FUNCTIONS ===
        function init() {
            renderStep(0);
        }

        function renderStep(index) {
            currentState.step = index;
            const container = document.getElementById('app-container');
            const template = document.getElementById(steps[index]);
            container.innerHTML = '';
            container.appendChild(template.content.cloneNode(true));
            
            updateHeader();
            
            // View specific inits
            if(steps[index] === 'view-types') initSortGame();
            if(steps[index] === 'view-material') initMaterialQuiz();
            if(steps[index] === 'view-compound') initCompoundGame();
            if(steps[index] === 'view-countable') initFridgeGame();
            if(steps[index] === 'view-exam') initExam();
            
            window.scrollTo(0,0);
        }

        function nextStep() {
            if(currentState.step < steps.length - 1) renderStep(currentState.step + 1);
        }

        function prevStep() {
            if(currentState.step > 0) renderStep(currentState.step - 1);
        }

        function updateHeader() {
            const bar = document.getElementById('progress-bar-container');
            bar.innerHTML = '';
            steps.forEach((_, i) => {
                const dot = document.createElement('div');
                dot.className = `h-2 w-2 rounded-full transition-all ${i === currentState.step ? 'bg-indigo-600 w-6' : i < currentState.step ? 'bg-indigo-300' : 'bg-slate-200'}`;
                bar.appendChild(dot);
            });
            document.getElementById('global-score').innerText = currentState.score;
        }

        function addScore(points) {
            currentState.score += points;
            document.getElementById('global-score').innerText = currentState.score;
            // animate score
            const badge = document.getElementById('global-score').parentElement;
            badge.classList.add('scale-110', 'bg-yellow-100');
            setTimeout(() => badge.classList.remove('scale-110', 'bg-yellow-100'), 200);
        }

        // === 1. SORT GAME LOGIC ===
        function initSortGame() {
            updateSortWord();
        }

        function updateSortWord() {
            if(currentState.sortIndex >= sortingWords.length) {
                // Win state
                document.getElementById('sort-word-display').innerText = "All Sorted!";
                document.getElementById('sort-word-display').classList.remove('animate-bounce');
                document.getElementById('sort-word-display').classList.add('text-green-400');
                document.getElementById('sort-feedback').innerText = "Excellent work!";
                
                const btn = document.getElementById('btn-next-1');
                btn.disabled = false;
                btn.classList.remove('bg-slate-300', 'cursor-not-allowed');
                btn.classList.add('bg-indigo-600', 'hover:bg-indigo-700');
                btn.innerHTML = `Next Lesson <span class="material-symbols-outlined">arrow_forward</span>`;
                btn.onclick = nextStep;
                return;
            }
            document.getElementById('sort-word-display').innerText = sortingWords[currentState.sortIndex].word;
        }

        function checkSort(type) {
            if(currentState.sortIndex >= sortingWords.length) return;
            
            const currentItem = sortingWords[currentState.sortIndex];
            const feedback = document.getElementById('sort-feedback');
            
            if(type === currentItem.type) {
                feedback.innerText = "Correct! " + currentItem.word + " is a " + type + " noun.";
                feedback.className = "h-8 mt-4 font-bold text-lg text-green-400";
                addScore(10);
                document.getElementById('sort-score').innerText = (currentState.sortIndex + 1);
                currentState.sortIndex++;
                setTimeout(() => {
                    feedback.innerText = "";
                    updateSortWord();
                }, 1000);
            } else {
                feedback.innerText = "Try again!";
                feedback.className = "h-8 mt-4 font-bold text-lg text-red-400";
            }
        }

        // === 2. MATERIAL QUIZ LOGIC ===
        function initMaterialQuiz() {
            const container = document.getElementById('material-quiz-container');
            materialQuestions.forEach((q, idx) => {
                const div = document.createElement('div');
                div.className = "bg-white p-4 rounded-xl shadow-sm border border-slate-200";
                div.innerHTML = `
                    <p class="font-serif text-lg mb-3">"${q.sentence}"</p>
                    <div class="flex gap-2">
                        ${q.options.map(opt => `
                            <button onclick="checkMaterial(this, '${opt}', '${q.answer}')" class="px-4 py-2 rounded-lg bg-slate-100 hover:bg-slate-200 text-sm font-bold text-slate-700 transition">${opt}</button>
                        `).join('')}
                    </div>
                `;
                container.appendChild(div);
            });
        }

        function checkMaterial(btn, selected, correct) {
            if(btn.disabled) return;
            const parent = btn.parentElement;
            const buttons = parent.querySelectorAll('button');
            buttons.forEach(b => b.disabled = true);

            if(selected === correct) {
                btn.classList.remove('bg-slate-100');
                btn.classList.add('bg-green-500', 'text-white');
                addScore(10);
            } else {
                btn.classList.remove('bg-slate-100');
                btn.classList.add('bg-red-500', 'text-white');
            }
        }

        // === 3. COMPOUND BUILDER LOGIC ===
        function initCompoundGame() {
            loadCompoundLevel();
        }

        function loadCompoundLevel() {
            if(currentState.compoundIndex >= compoundLevels.length) {
                document.getElementById('compound-def').innerText = "Factory Complete!";
                document.getElementById('compound-options').innerHTML = "";
                const btn = document.getElementById('btn-next-3');
                btn.disabled = false;
                btn.classList.remove('bg-slate-300', 'cursor-not-allowed');
                btn.classList.add('bg-indigo-600', 'hover:bg-indigo-700');
                btn.innerHTML = `Next Lesson <span class="material-symbols-outlined">arrow_forward</span>`;
                btn.onclick = nextStep;
                return;
            }

            const level = compoundLevels[currentState.compoundIndex];
            document.getElementById('compound-def').innerText = level.def;
            
            const container = document.getElementById('compound-options');
            container.innerHTML = `
                <div class="space-y-2">
                    <p class="text-xs uppercase text-slate-400">Part 1</p>
                    ${level.part1.map(w => `<button onclick="selectCompoundPart(1, '${w}')" id="p1-${w}" class="w-full p-3 bg-slate-700 hover:bg-slate-600 rounded-lg font-bold part-btn-1">${w}</button>`).join('')}
                </div>
                <div class="space-y-2">
                    <p class="text-xs uppercase text-slate-400">Part 2</p>
                    ${level.part2.map(w => `<button onclick="selectCompoundPart(2, '${w}')" id="p2-${w}" class="w-full p-3 bg-slate-700 hover:bg-slate-600 rounded-lg font-bold part-btn-2">${w}</button>`).join('')}
                </div>
            `;
        }

        let selectedP1 = null;
        let selectedP2 = null;

        function selectCompoundPart(part, word) {
            if(part === 1) {
                document.querySelectorAll('.part-btn-1').forEach(b => b.classList.remove('bg-yellow-500', 'text-black'));
                document.getElementById(`p1-${word}`).classList.add('bg-yellow-500', 'text-black');
                selectedP1 = word;
            } else {
                document.querySelectorAll('.part-btn-2').forEach(b => b.classList.remove('bg-yellow-500', 'text-black'));
                document.getElementById(`p2-${word}`).classList.add('bg-yellow-500', 'text-black');
                selectedP2 = word;
            }

            if(selectedP1 && selectedP2) checkCompound();
        }

        function checkCompound() {
            const level = compoundLevels[currentState.compoundIndex];
            const combined = selectedP1 + selectedP2;
            
            if(combined.toLowerCase() === level.answer.toLowerCase()) {
                document.getElementById('compound-feedback').innerText = "Built: " + combined + " ‚úÖ";
                addScore(20);
                currentState.compoundIndex++;
                selectedP1 = null;
                selectedP2 = null;
                setTimeout(() => {
                    document.getElementById('compound-feedback').innerText = "";
                    loadCompoundLevel();
                }, 1000);
            } else {
                document.getElementById('compound-feedback').innerText = "Invalid: " + combined + " ‚ùå";
                document.getElementById('compound-feedback').classList.replace('text-green-400', 'text-red-400');
                setTimeout(() => {
                    document.getElementById('compound-feedback').innerText = "";
                    document.getElementById('compound-feedback').classList.replace('text-red-400', 'text-green-400');
                    // Reset selection visuals
                     document.querySelectorAll('button').forEach(b => b.classList.remove('bg-yellow-500', 'text-black'));
                     selectedP1 = null;
                     selectedP2 = null;
                }, 1000);
            }
        }

        // === 4. FRIDGE GAME LOGIC ===
        function initFridgeGame() {
            loadFridgeItem();
        }

        function loadFridgeItem() {
            if(currentState.fridgeIndex >= fridgeItems.length) {
                document.getElementById('fridge-item').parentElement.innerHTML = "<div class='text-2xl font-bold text-green-600'>Fridge Stocked!</div>";
                const btn = document.getElementById('btn-next-4');
                btn.disabled = false;
                btn.classList.remove('bg-slate-300', 'cursor-not-allowed');
                btn.classList.add('bg-indigo-600', 'hover:bg-indigo-700');
                btn.innerHTML = `Start Final Exam <span class="material-symbols-outlined">edit_document</span>`;
                btn.onclick = nextStep;
                return;
            }

            const item = fridgeItems[currentState.fridgeIndex];
            document.getElementById('fridge-item').innerHTML = `
                <span class="material-symbols-outlined text-5xl text-yellow-600 mb-2">${item.icon}</span>
                <span class="font-bold text-slate-700">${item.name}</span>
            `;
            document.getElementById('fridge-status').innerText = `Items sorted: ${currentState.fridgeIndex}/${fridgeItems.length}`;
        }

        function sortFridge(bucket) {
            if(currentState.fridgeIndex >= fridgeItems.length) return;
            const item = fridgeItems[currentState.fridgeIndex];
            
            if(item.type === bucket) {
                addScore(10);
                currentState.fridgeIndex++;
                // Animation
                const el = document.getElementById('fridge-item');
                el.classList.add('scale-0', 'opacity-0');
                setTimeout(() => {
                    el.classList.remove('scale-0', 'opacity-0');
                    loadFridgeItem();
                }, 300);
            } else {
                alert("Oops! Think again. Can you count " + item.name + " individually?");
            }
        }

        // === 5. EXAM LOGIC ===
        function initExam() {
            loadExamQuestion();
        }

        function loadExamQuestion() {
            if(currentState.examIndex >= examQuestions.length) {
                // Exam Done
                nextStep(); // Go to certificate
                return;
            }

            const q = examQuestions[currentState.examIndex];
            const card = document.getElementById('exam-card');
            
            document.getElementById('exam-counter').innerText = `${currentState.examIndex + 1}/${examQuestions.length}`;
            document.getElementById('exam-progress').style.width = `${((currentState.examIndex)/examQuestions.length)*100}%`;

            card.innerHTML = `
                <h3 class="text-xl md:text-2xl font-bold text-slate-800 mb-8">${q.q}</h3>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    ${q.options.map((opt, i) => `
                        <button onclick="answerExam(${i})" class="text-left p-4 rounded-xl border-2 border-slate-200 hover:border-indigo-500 hover:bg-indigo-50 transition font-semibold text-slate-700">${opt}</button>
                    `).join('')}
                </div>
            `;
        }

        function answerExam(choiceIdx) {
            const q = examQuestions[currentState.examIndex];
            if(choiceIdx === q.a) {
                currentState.examScore++;
                addScore(20); // Big points for exam
            }
            currentState.examIndex++;
            loadExamQuestion();
        }

        // === 6. CERTIFICATE ===
        function generateCertificate() {
            const name = document.getElementById('student-name').value;
            if(!name) {
                alert("Please enter your name!");
                return;
            }
            
            document.getElementById('cert-name').innerText = name;
            
            // Calculate final percentage based on total possible questions (approx)
            // Sort(5*10) + Material(3*10) + Compound(3*20) + Fridge(6*10) + Exam(10*20) = 50+30+60+60+200 = 400
            const percentage = Math.min(100, Math.round((currentState.score / 400) * 100));
            document.getElementById('cert-score').innerText = percentage + "%";
            
            const d = new Date();
            document.getElementById('cert-date').innerText = d.toLocaleDateString();

            document.getElementById('cert-input-area').classList.add('hidden');
            document.getElementById('certificate-display').classList.remove('hidden');
            document.getElementById('certificate-display').classList.add('fade-in');
        }

        function shareResult() {
            const score = document.getElementById('global-score').innerText;
            const text = `I just became a Certified Noun Master with a score of ${score} points! üéì #NounMaster`;
            
            if (navigator.share) {
                navigator.share({
                    title: 'Noun Master Academy',
                    text: text,
                    url: window.location.href,
                }).catch(console.error);
            } else {
                // Fallback to clipboard
                navigator.clipboard.writeText(text).then(() => {
                    alert("Result copied to clipboard!");
                });
            }
        }

        function resetApp() {
            currentState = {
                step: 0,
                score: 0,
                sortIndex: 0,
                sortScore: 0,
                compoundIndex: 0,
                fridgeIndex: 0,
                fridgeScore: 0,
                examIndex: 0,
                examScore: 0
            };
            init();
        }

        // === SOURCE CODE VIEWER ===
        function showSourceCode() {
            const html = '<!DOCTYPE html>\n' + document.documentElement.outerHTML;
            const modal = document.getElementById('code-viewer-modal');
            const textarea = document.getElementById('source-code-area');
            
            textarea.value = html;
            modal.classList.remove('hidden');
            modal.classList.add('flex');
            document.body.style.overflow = 'hidden'; // Prevent background scrolling
        }

        function closeSourceCode() {
            const modal = document.getElementById('code-viewer-modal');
            modal.classList.add('hidden');
            modal.classList.remove('flex');
            document.body.style.overflow = 'auto'; // Restore scrolling
        }

        async function copyToClipboard() {
            const textarea = document.getElementById('source-code-area');
            try {
                await navigator.clipboard.writeText(textarea.value);
                const btn = document.querySelector('#code-viewer-modal button:first-child');
                const originalText = btn.innerHTML;
                
                btn.innerHTML = '<span class="material-symbols-outlined text-sm">check</span> Copied!';
                btn.classList.replace('bg-indigo-600', 'bg-green-600');
                
                setTimeout(() => {
                    btn.innerHTML = originalText;
                    btn.classList.replace('bg-green-600', 'bg-indigo-600');
                }, 2000);
            } catch (err) {
                alert('Failed to copy text.');
            }
        }

        // Start
        init();

    </script>

</body></html>